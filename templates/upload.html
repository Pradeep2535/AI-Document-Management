<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UI/UX</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@48,400,0,0" />
  <link rel="stylesheet" href="/static/css/style.css">
  <link rel="stylesheet" href="/static/css/upload.css">
</head>
<body>
   <div class="container">
      <aside style="position: fixed;">
        
         <div class="top">
           <div class="logo">
             <h2>C <span class="danger">BABAR</span> </h2>
           </div>
           <div class="close" id="close_btn">
            <span class="material-symbols-sharp">
              close
              </span>
           </div>
         </div>
         <!-- end top -->
          <div class="sidebar">

            <a href="/">
              <span class="material-symbols-sharp">grid_view </span>
              <h3>Dashbord</h3>
           </a>
           <a href="/customer">
              <span class="material-symbols-sharp">person_outline </span>
              <h3>custumers</h3>
           </a>
           <a href="#">
              <span class="material-symbols-sharp">insights </span>
              <h3>Analytics</h3>
           </a>
           <a href="#">
              <span class="material-symbols-sharp">mail_outline </span>
              <h3>Messages</h3>
           
           </a>
           <a href="/upload" class="active">
              <span class="material-symbols-sharp">receipt_long </span>
              <h3>Upload</h3>
           </a>
           <a href="/transaction">
            <span class="material-symbols-sharp">report_gmailerrorred </span>
            <h3>transaction History</h3>
           </a>
           <a href="#">
              <span class="material-symbols-sharp">settings </span>
              <h3>settings</h3>
           </a>
           <a href="#">
              <span class="material-symbols-sharp">add </span>
              <h3>Add policy</h3>
           </a>
           <a href="#">
              <span class="material-symbols-sharp">logout </span>
              <h3 id="logoutButton">logout</h3>

               <!-- Dialog Box -->
                <div id="dialogBox" class="dialog-box">
                    <div class="dialog-content">
                        <h3>retry......</h3>
                        <div class="dialog-actions">
                            <button id="retryButton">retry</button>
                        </div>
                    </div>
                </div>
           </a>
             


          </div>

      </aside>
      <!-- --------------
        end asid
      -------------------- -->

      <!-- --------------
        start main part
      --------------- -->

      <main>
        <div class="dashboard-item"> 
            <h1>Upload</h1>

          

           <div class="flex-container" style="margin-left:100px;">
            <div class="container-1">
                <div class="folder">
                  <div class="front-side">
                    <div class="tip"></div>
                    <div class="cover"></div>
                  </div>
                  <div class="back-side cover"></div>
                </div>
                <form id="uploadForm">
                  <label class="custom-file-upload">
                      <input type="file" id="upload" name="file" accept=".pdf,.jpg,.jpeg,.png" required/>
                      Choose a file
                  </label>
                  <button type="submit" class="upload-btn">Upload</button>
              </form>
              <div id="dialogBox-1" class="dialog-box-1">
                <div class="dialog-content-1">
                    <h3>Are you sure you want to log out?</h3>
                    <div class="dialog-actions-1">
                        
                    </div>
                </div>
            </div>
              <div id="response"></div>
              </div>
        </div>
       <!-- end insights -->
        </div>

    </main>
      <!------------------
         end main
        ------------------->

      <!----------------
        start right main 
      ---------------------->
    <!-- <div class="right">

<div class="top">
   <button id="menu_bar">
     <span class="material-symbols-sharp">menu</span>
   </button>

   <div class="theme-toggler">
     <span class="material-symbols-sharp active">light_mode</span>
     <span class="material-symbols-sharp">dark_mode</span>
   </div>
    <div class="profile">
       <div class="info">
           <p><b>Babar</b></p>
           <p>Admin</p>
           <small class="text-muted"></small>
       </div>
       <div class="profile-photo">
         <img src="profile-1.jpg" alt=""/>
       </div>
    </div>
</div>

  <div class="recent_updates">
     <h2>Recent Update</h2>
   <div class="updates">
      <div class="update">
         <div class="profile-photo">
            <img src="profile-4.jpg" alt=""/>
         </div>
        <div class="message">
           <p><b>todo list</b> pothanum</p>
        </div>
      </div>
      <div class="update">
        <div class="profile-photo">
        <img src="profile-3.jpg" alt=""/>
        </div>
       <div class="message">
          <p><b>pothanum</b>pothanum</p>
       </div>
     </div>
     <div class="update">
      <div class="profile-photo">
         <img src="profile-2.jpg" alt=""/>
      </div>
     <div class="message">
        <p><b>Ramzan</b> Recived his order of USB</p>
     </div>
   </div>
  </div>
  </div>


   <div class="sales-an    <div class="container-2">
      <h1>Dynamic Customer Table</h1>
      <table id="customerTable">
          <thead>
              <tr>
                  <th>Customer ID</th>
                  <th>Customer Name</th>
                  <th>Actions</th>
              </tr>
          </thead>
          <tbody>
              <!-- Rows will be added dynamically -->
          </tbody>
      </table>
  </div>alytics">
     <h2>Sales Analytics</h2>

      <div class="item onlion">
        <div class="icon">
          <span class="material-symbols-sharp">shopping_cart</span>
        </div>
        <div class="right_text">
          <div class="info">
            <h3>Onlion Orders</h3>
            <small class="text-muted">Last seen 2 Hours</small>
          </div>
          <h5 class="danger">-17%</h5>
          <h3>3849</h3>
        </div>
      </div>
      <div class="item onlion">
        <div class="icon">
          <span class="material-symbols-sharp">shopping_cart</span>
        </div>
        <div class="right_text">
          <div class="info">
            <h3>Onlion Orders</h3>
            <small class="text-muted">Last seen 2 Hours</small>
          </div>
          <h5 class="success">-17%</h5>
          <h3>3849</h3>
        </div>
      </div>
      <div class="item onlion">
        <div class="icon">
          <span class="material-symbols-sharp">shopping_cart</span>
        </div>
        <div class="right_text">
          <div class="info">
            <h3>Onlion Orders</h3>
            <small class="text-muted">Last seen 2 Hours</small>
          </div>
          <h5 class="danger">-17%</h5>
          <h3>3849</h3>
        </div>
      </div>
   
  

</div>

      <div class="item add_product">
            <div>
            <span class="material-symbols-sharp">add</span>
            </div>
     </div>
</div>


   </div> -->



   <script >
    const retryButton = document.getElementById("retryButton");

// Add click event listener to the button
retryButton.addEventListener("click", function () {
    dialogBox.style.display = "block"; // Show the dialog box
});
    document.getElementById('uploadForm').onsubmit = async function (e) {
      e.preventDefault();
      
      let formData = new FormData();
      let fileInput = document.getElementById('upload');
      formData.append("file", fileInput.files[0]);

      const response = await fetch('/upload_file', {
          method: 'POST',
          body: formData
      });

      const result = await response.json();
      console.log("--------------------------------------------------------------");
      console.log(result);
      function showDialogBox(result) {
        if (result === "unsupported" || result==="upload_different_document" || result==="network_error" || result==="display_accounts") {
        const dialogBox = document.getElementById("dialogBox-1");
        dialogBox.style.display = "block"; // Make the dialog box visible
    }
}
showDialogBox(result);
      const responseDiv = document.getElementById('response');
      //console.log(result);
      if (result.upload_status === 'success') {
          responseDiv.innerHTML = '<p>File uploaded successfully!</p>';
      } else if (result.upload_status === 'display_accounts') {
          responseDiv.innerHTML = '<p>Multiple accounts found. Please choose one:</p>';
          
          result.accounts.forEach(account => {
              const btn = document
              .createElement('button');
              btn.innerText = `Select Account: ${account.acc_no}`;
              btn.onclick = () => selectAccount(account.acc_no, result.file_document, result.document_type);
              responseDiv.appendChild(btn);
          });
      } else {
          responseDiv.innerHTML = `<p>Upload failed: ${result.upload_status}</p>`;
      }
  };

  async function selectAccount(account_no, file_document, document_type) {
      const response = await fetch('/confirm_account', {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json'
          },
          body: JSON.stringify({
              account_no,
              file_document,
              document_type
          })
      });

      const result = await response.json();
      console.log("--------------------------------------------------------------");
      console.log(result);
      document.getElementById('response').innerHTML = `<p>${result.message}</p>`;
  }
    
   </script>
</body>
</html>